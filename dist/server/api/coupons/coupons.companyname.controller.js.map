{"version":3,"sources":["api/coupons/coupons.companyname.controller.js"],"names":["google","require","gmail","OAuth2","auth","credentials","oauth2Client","client_id","client_secret","redirect_uri","module","exports","req","res","accessToken","headers","access_token","userId","params","id","setCredentials","users","messages","get","format","metadataHeaders","err","response","console","log","status","code","send","errors","reqRes","data","payload"],"mappings":";;AAAA;;;;AAIA,IAAIA,SAASC,QAAQ,YAAR,CAAb;AACA,IAAIC,QAAQF,OAAOE,KAAP,CAAa,IAAb,CAAZ;AACA,IAAIC,SAASH,OAAOI,IAAP,CAAYD,MAAzB;AACA,IAAME,cAAcJ,QAAQ,uCAAR,CAApB;;AAEA,IAAIK,eAAe,IAAIH,MAAJ,CACjBE,YAAYE,SADK,EAEjBF,YAAYG,aAFK,EAGjBH,YAAYI,YAAZ,CAAyB,CAAzB,CAHiB,CAAnB;;AAMAC,OAAOC,OAAP,GAAiB,UAASC,GAAT,EAAcC,GAAd,EAAkB;;AAEjC,MAAIC,cAAcF,IAAIG,OAAJ,CAAYC,YAA9B;AACA,MAAIC,SAASL,IAAIM,MAAJ,CAAWD,MAAxB;AACA,MAAIE,KAAKP,IAAIM,MAAJ,CAAWC,EAApB;;AAEAb,eAAac,cAAb,CAA4B;AAC1BJ,kBAAcF;AADY,GAA5B;;AAIAZ,QAAMmB,KAAN,CAAYC,QAAZ,CAAqBC,GAArB,CAAyB;AACvBN,YAAQA,MADe;AAEvBE,QAAKA,EAFkB;AAGvBf,UAAME,YAHiB;AAIvBkB,YAAQ,UAJe;AAKvBC,qBAAiB;AALM,GAAzB,EAMG,UAAUC,GAAV,EAAeC,QAAf,EAAyB;;AAE1B,QAAID,GAAJ,EAAQ;AACNE,cAAQC,GAAR,CAAYH,GAAZ;AACAb,UAAIiB,MAAJ,CAAWJ,IAAIK,IAAf,EAAqBC,IAArB,CAA0B,EAACC,QAAQP,IAAIO,MAAb,EAA1B;AACD,KAHD,MAIK;AACH,UAAIC,SAAS;AACXC,cAAOR,SAASS;AADL,OAAb;AAGAvB,UAAIiB,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqBE,MAArB;AACD;AACF,GAlBD;AAmBD,CA7BD","file":"coupons.companyname.controller.js","sourcesContent":["/**\n * Created by Lazaro on 2/18/2017.\n */\n\nvar google = require('googleapis');\nvar gmail = google.gmail('v1');\nvar OAuth2 = google.auth.OAuth2;\nconst credentials = require('../../.credentials/google_credentials');\n\nvar oauth2Client = new OAuth2(\n  credentials.client_id,\n  credentials.client_secret,\n  credentials.redirect_uri[1]\n);\n\nmodule.exports = function(req, res){\n\n  var accessToken = req.headers.access_token;\n  var userId = req.params.userId;\n  var id = req.params.id;\n\n  oauth2Client.setCredentials({\n    access_token: accessToken\n  });\n\n  gmail.users.messages.get({\n    userId: userId,\n    id : id,\n    auth: oauth2Client,\n    format: 'metadata',\n    metadataHeaders: 'From',\n  }, function (err, response) {\n\n    if (err){\n      console.log(err);\n      res.status(err.code).send({errors: err.errors});\n    }\n    else {\n      var reqRes = {\n        data : response.payload\n      };\n      res.status(200).send(reqRes);\n    }\n  });\n}\n"]}