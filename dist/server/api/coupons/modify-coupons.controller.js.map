{"version":3,"sources":["api/coupons/modify-coupons.controller.js"],"names":["google","require","gmail","OAuth2","auth","credentials","oauth2Client","client_id","client_secret","redirect_uri","module","exports","req","res","accessToken","body","headers","access_token","userId","params","id","setCredentials","users","messages","modify","resource","removeLabelIds","err","response","console","log","status","code","send","errors"],"mappings":";;AAAA;;;AAGA,IAAIA,SAASC,QAAQ,YAAR,CAAb;AACA,IAAIC,QAAQF,OAAOE,KAAP,CAAa,IAAb,CAAZ;AACA,IAAIC,SAASH,OAAOI,IAAP,CAAYD,MAAzB;AACA,IAAME,cAAcJ,QAAQ,uCAAR,CAApB;;AAEA,IAAIK,eAAe,IAAIH,MAAJ,CACjBE,YAAYE,SADK,EAEjBF,YAAYG,aAFK,EAGjBH,YAAYI,YAAZ,CAAyB,CAAzB,CAHiB,CAAnB;;AAMAC,OAAOC,OAAP,GAAiB,UAASC,GAAT,EAAcC,GAAd,EAAkB;;AAEjC,MAAIC,cAAcF,IAAIG,IAAJ,CAASC,OAAT,CAAiBC,YAAnC;AACA,MAAIC,SAASN,IAAIO,MAAJ,CAAWD,MAAxB;AACA,MAAIE,KAAKR,IAAIO,MAAJ,CAAWC,EAApB;;AAEAd,eAAae,cAAb,CAA4B;AAC1BJ,kBAAcH;AADY,GAA5B;;AAIAZ,QAAMoB,KAAN,CAAYC,QAAZ,CAAqBC,MAArB,CAA4B;AAC1BN,YAAQA,MADkB;AAE1BE,QAAKA,EAFqB;AAG1BhB,UAAME,YAHoB;AAI1BmB,cAAS;AACPC,sBAAgB,CAAC,QAAD;AADT;AAJiB,GAA5B,EAOG,UAAUC,GAAV,EAAeC,QAAf,EAAyB;AAC1B,QAAGD,GAAH,EAAO;AACLE,cAAQC,GAAR,CAAYH,GAAZ;AACAd,UAAIkB,MAAJ,CAAWJ,IAAIK,IAAf,EAAqBC,IAArB,CAA0B,EAACC,QAAQP,IAAIO,MAAb,EAA1B;AACD,KAHD,MAIK;AACHrB,UAAIkB,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqBL,SAASL,QAA9B;AACD;AACF,GAfD;AAgBD,CA1BD","file":"modify-coupons.controller.js","sourcesContent":["/**\n * Created by Lazaro on 3/18/2017.\n */\nvar google = require('googleapis');\nvar gmail = google.gmail('v1');\nvar OAuth2 = google.auth.OAuth2;\nconst credentials = require('../../.credentials/google_credentials');\n\nvar oauth2Client = new OAuth2(\n  credentials.client_id,\n  credentials.client_secret,\n  credentials.redirect_uri[1]\n);\n\nmodule.exports = function(req, res){\n\n  var accessToken = req.body.headers.access_token;\n  var userId = req.params.userId;\n  var id = req.params.id;\n\n  oauth2Client.setCredentials({\n    access_token: accessToken\n  });\n\n  gmail.users.messages.modify({\n    userId: userId,\n    id : id,\n    auth: oauth2Client,\n    resource:{\n      removeLabelIds: [\"UNREAD\"]\n    },\n  }, function (err, response) {\n    if(err){\n      console.log(err);\n      res.status(err.code).send({errors: err.errors});\n    }\n    else {\n      res.status(200).send(response.messages);\n    }\n  });\n};\n"]}